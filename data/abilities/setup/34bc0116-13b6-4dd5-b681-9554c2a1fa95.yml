- id: 34bc0116-13b6-4dd5-b681-9554c2a1fa95
  name: Backup Sensitive Files
  description: Backup sensitive files to temp directory in case these files are maliciously modified
  tactic: setup
  technique:
    attack_id: x
    name: x
  repeatable: False
  platforms:
    linux:
      sh:
        command: |
          [[ -d /tmp/sensitive_files_backup ]] || mkdir /tmp/sensitive_files_backup;
          files=($(find #{file.sensitive.path} 2>/dev/null));
          output=""
          for file in ${files[@]}; do randname=$(head /dev/urandom | tr -dc A-Za-z0-9 | head -c 13); cp $file /tmp/sensitive_files_backup/$randname; output+="${randname}>${file};" done;
          echo $output | tr ";" "\n"
        parsers:
          plugins.response.app.parsers.file_info:
            - source: file.sensitive.path
              edge: has_backup
              target: file.backup.name